import{CorePlayer}from"./core/Player.js";class PreviewPlayerManager{constructor(){this.player=null,this.currentVideoId=null,this.currentBlobUrl=null,this.templatesLoaded=!1}async _loadTemplates(){if(!this.templatesLoaded)try{const e=await fetch("assets/templates/player-templates.html"),t=await e.text(),r=document.createElement("div");r.innerHTML=t,document.body.append(...r.children),this.templatesLoaded=!0,console.log("Player templates loaded")}catch(e){throw console.error("Failed to load player templates:",e),e}}async init(){await this._loadTemplates(),this.player=new CorePlayer("preview-player-container",{mode:"editor",controls:!0,autoplay:!1,loop:!1}),console.log("CorePlayer initialized in preview panel")}async loadVideo(e,t,r){if(this.player)try{this.currentBlobUrl&&URL.revokeObjectURL(this.currentBlobUrl),this.currentBlobUrl=URL.createObjectURL(e),await this.player.loadMedia(this.currentBlobUrl),this.currentVideoId=t,console.log(`Loaded video: ${r}`)}catch(e){throw console.error("Failed to load video:",e),e}else console.error("Player not initialized")}getPlayer(){return this.player}getCurrentVideoId(){return this.currentVideoId}}export const previewPlayerManager=new PreviewPlayerManager;document.addEventListener("DOMContentLoaded",async()=>{try{await previewPlayerManager.init()}catch(e){console.error("Failed to initialize preview player:",e)}});