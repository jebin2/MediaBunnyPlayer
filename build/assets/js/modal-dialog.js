export class ModalDialog{constructor(){this.overlay=null,this.dialog=null,this.focusTrapHandler=null}show(e,t,a=[]){this.close(),this.overlay=document.createElement("div"),this.overlay.className="modal-overlay",this.dialog=document.createElement("div"),this.dialog.className="modal",this.dialog.setAttribute("role","alertdialog"),this.dialog.setAttribute("aria-modal","true"),this.dialog.setAttribute("aria-labelledby","modal-title"),this.dialog.setAttribute("aria-describedby","modal-message"),this.dialog.innerHTML=`\n            <h2 id="modal-title" class="modal__title">${e}</h2>\n            <p id="modal-message" class="modal__message">${t}</p>\n            <div class="modal__actions"></div>\n        `;const l=this.dialog.querySelector(".modal__actions");a.forEach(e=>{const t=document.createElement("button");t.className=`modal-btn modal-btn--${e.type||"secondary"}`,t.textContent=e.text,t.addEventListener("click",()=>{e.callback&&e.callback(),this.close()}),l.appendChild(t)}),this.overlay.appendChild(this.dialog),document.body.appendChild(this.overlay),this.trapFocus(this.dialog);const o=l.querySelector("button");o&&o.focus(),this.escapeHandler=e=>{if("Escape"===e.key){const e=a.find(e=>"secondary"===e.type||"cancel"===e.text.toLowerCase());e&&e.callback&&e.callback(),this.close()}},document.addEventListener("keydown",this.escapeHandler)}close(){this.overlay&&(this.overlay.remove(),this.overlay=null,this.dialog=null),this.escapeHandler&&(document.removeEventListener("keydown",this.escapeHandler),this.escapeHandler=null)}trapFocus(e){e.addEventListener("keydown",t=>{if("Tab"!==t.key)return;const a=e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])'),l=a[0],o=a[a.length-1];t.shiftKey?document.activeElement===l&&(o.focus(),t.preventDefault()):document.activeElement===o&&(l.focus(),t.preventDefault())})}}export const modalDialog=new ModalDialog;