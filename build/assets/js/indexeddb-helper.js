const DB_NAME="MediaLibraryDB",DB_VERSION=1,STORE_NAME="media";class IndexedDBHelper{constructor(){this.db=null}async init(){return new Promise((e,t)=>{const r=indexedDB.open(DB_NAME,1);r.onerror=()=>t(r.error),r.onsuccess=()=>{this.db=r.result,e(this.db)},r.onupgradeneeded=e=>{const t=e.target.result;if(!t.objectStoreNames.contains("media")){const e=t.createObjectStore("media",{keyPath:"id"});e.createIndex("type","type",{unique:!1}),e.createIndex("dateAdded","dateAdded",{unique:!1})}}})}async addMedia(e){return this.db||await this.init(),new Promise((t,r)=>{const i=this.db.transaction(["media"],"readwrite").objectStore("media").add(e);i.onsuccess=()=>t(e.id),i.onerror=()=>r(i.error)})}async getMedia(e){return this.db||await this.init(),new Promise((t,r)=>{const i=this.db.transaction(["media"],"readonly").objectStore("media").get(e);i.onsuccess=()=>t(i.result),i.onerror=()=>r(i.error)})}async getAllMediaByType(e){return this.db||await this.init(),new Promise((t,r)=>{const i=this.db.transaction(["media"],"readonly").objectStore("media").index("type").getAll(e);i.onsuccess=()=>t(i.result),i.onerror=()=>r(i.error)})}async deleteMedia(e){return this.db||await this.init(),new Promise((t,r)=>{const i=this.db.transaction(["media"],"readwrite").objectStore("media").delete(e);i.onsuccess=()=>t(),i.onerror=()=>r(i.error)})}}export const dbHelper=new IndexedDBHelper;