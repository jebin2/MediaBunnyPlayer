class ClipRenderer{constructor(){this.minClipWidth=20,this.setupThumbnailListener()}setupThumbnailListener(){window.addEventListener("thumbnail-ready",e=>{const{mediaId:t,thumbnail:i}=e.detail;this.updateClipThumbnails(t,i)})}updateClipThumbnails(e,t){document.querySelectorAll(`.timeline-clip[data-media-id="${e}"]`).forEach(e=>{e.style.backgroundImage=`url(${t})`,e.classList.add("timeline-clip--has-thumbnail")})}renderClip(e){const t=document.querySelector(`.timeline-track[data-track-id="${e.trackId}"]`);if(!t)return void console.warn(`Track not found for clip: ${e.id}`);const i=t.querySelector(".timeline-track__content");if(!i)return;const l=document.createElement("div");l.className=`timeline-clip timeline-clip--${e.type}`,l.dataset.clipId=e.id,l.dataset.mediaId=e.mediaId,l.dataset.trackId=e.trackId,l.dataset.startTime=e.startTime,l.dataset.duration=e.duration;const n=document.createElement("span");if(n.className="timeline-clip__label",n.textContent=e.name,l.appendChild(n),this.updateElementPosition(l,e),"video"===e.type&&window.thumbnailExtractor){const t=window.thumbnailExtractor.getThumbnail(e.mediaId);t&&(l.style.backgroundImage=`url(${t})`,l.classList.add("timeline-clip--has-thumbnail"))}i.appendChild(l)}renderAllClips(e){this.clearClips(),e.forEach(e=>this.renderClip(e))}clearClips(){document.querySelectorAll(".timeline-clip").forEach(e=>e.remove())}updateElementPosition(e,t){const i=window.timelineManager;if(!i)return;const l=i.zoomLevel/100,n=i.pixelsPerSecond*l,a=t.startTime*n;let d=t.duration*n;d<this.minClipWidth?(d=this.minClipWidth,e.classList.add("timeline-clip--short")):e.classList.remove("timeline-clip--short"),e.style.left=`${a}px`,e.style.width=`${d}px`}refresh(){if(window.clipManager){window.clipManager.getClips().forEach(e=>{const t=document.querySelector(`.timeline-clip[data-clip-id="${e.id}"]`);t?this.updateElementPosition(t,e):this.renderClip(e)})}}}window.clipRenderer=new ClipRenderer;export default window.clipRenderer;