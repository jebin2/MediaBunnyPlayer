class ClipRenderer{constructor(){this.minClipWidth=20,this.setupThumbnailListener()}setupThumbnailListener(){window.addEventListener("thumbnail-ready",e=>{const{mediaId:t,thumbnail:i}=e.detail;this.updateClipThumbnails(t,i)})}updateClipThumbnails(e,t){document.querySelectorAll(`.timeline-clip[data-media-id="${e}"]`).forEach(e=>{e.style.backgroundImage=`url(${t})`,e.classList.add("timeline-clip--has-thumbnail")})}renderClip(e){const t=document.querySelector(`.timeline-track[data-track-id="${e.trackId}"]`);if(!t)return void console.warn(`Track not found for clip: ${e.id}`);if(!t.querySelector(".timeline-track__content"))return;const i=document.createElement("div");i.className=`timeline-clip timeline-clip--${e.type}`,i.dataset.clipId=e.id,i.dataset.mediaId=e.mediaId,i.dataset.trackId=e.trackId,i.dataset.startTime=e.startTime,i.dataset.duration=e.duration;const n=document.createElement("span");n.className="timeline-clip__label",n.textContent=e.name,i.appendChild(n),this.updateElementPosition(i,e);const a=document.createElement("div");a.className="clip-handle handle-left",a.dataset.action="trim-left",i.appendChild(a);const l=document.createElement("div");if(l.className="clip-handle handle-right",l.dataset.action="trim-right",i.appendChild(l),"video"===e.type&&window.thumbnailExtractor){const t=window.thumbnailExtractor.getThumbnail(e.mediaId);t&&(i.style.backgroundImage=`url(${t})`,i.classList.add("timeline-clip--has-thumbnail"))}const d=document.querySelector(`.timeline-track[data-track-id="${e.trackId}"] .timeline-track__content`);d?(d.appendChild(i),console.log(`Rendered clip ${e.id} to track ${e.trackId}`)):console.error(`Track content not found for track ${e.trackId} when rendering clip ${e.id}`)}renderAllClips(e){this.clearClips(),e.forEach(e=>this.renderClip(e))}clearClips(){document.querySelectorAll(".timeline-clip").forEach(e=>e.remove())}updateElementPosition(e,t){const i=window.timelineManager;if(!i)return;const n=i.zoomLevel/100,a=i.pixelsPerSecond*n,l=t.startTime*a;let d=t.duration*a;d<this.minClipWidth?(d=this.minClipWidth,e.classList.add("timeline-clip--short")):e.classList.remove("timeline-clip--short"),e.style.left=`${l}px`,e.style.width=`${d}px`}refresh(){window.clipManager&&window.clipManager.getClips().forEach(e=>{const t=document.querySelector(`.timeline-clip[data-clip-id="${e.id}"]`);t?this.updateElementPosition(t,e):this.renderClip(e)})}}window.clipRenderer=new ClipRenderer;export default window.clipRenderer;