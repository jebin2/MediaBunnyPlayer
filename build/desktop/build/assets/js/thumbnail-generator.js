export class ThumbnailGenerator{constructor(){this.thumbnailWidth=200,this.thumbnailHeight=150,this.thumbnailQuality=.75,this.seekTime=.1}async generateThumbnail(t){return new Promise((e,i)=>{const a=document.createElement("video");a.preload="metadata",a.muted=!0;let h=null;const n=()=>{h&&URL.revokeObjectURL(h),a.remove()};a.onerror=()=>{n(),i(new Error("Failed to load video for thumbnail generation"))},a.onseeked=async()=>{try{const t=await this.captureFrame(a);n(),e(t)}catch(t){n(),i(t)}},a.onloadedmetadata=()=>{a.currentTime=this.seekTime},h=URL.createObjectURL(t),a.src=h})}captureFrame(t){return new Promise((e,i)=>{try{const a=document.createElement("canvas");a.width=this.thumbnailWidth,a.height=this.thumbnailHeight;const h=a.getContext("2d"),n=t.videoWidth/t.videoHeight,o=this.thumbnailWidth/this.thumbnailHeight;let r=0,d=0,m=t.videoWidth,s=t.videoHeight;n>o?(m=t.videoHeight*o,r=(t.videoWidth-m)/2):(s=t.videoWidth/o,d=(t.videoHeight-s)/2),h.drawImage(t,r,d,m,s,0,0,this.thumbnailWidth,this.thumbnailHeight),a.toBlob(t=>{t?e(t):i(new Error("Failed to export canvas to blob"))},"image/jpeg",this.thumbnailQuality)}catch(t){i(t)}})}}export const thumbnailGenerator=new ThumbnailGenerator;